<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>MySQL | Angelday</title><meta name="description" content="お帰りなさい">
    <link rel="preload" href="/assets/style-PoWje89h.css" as="style"><link rel="stylesheet" href="/assets/style-PoWje89h.css">
    <link rel="modulepreload" href="/assets/app-BuZoRmWt.js"><link rel="modulepreload" href="/assets/mysql.html-D96uMSn8.js">
    <link rel="prefetch" href="/assets/index.html-BEZE697q.js" as="script"><link rel="prefetch" href="/assets/css.html-DzvAFNci.js" as="script"><link rel="prefetch" href="/assets/html.html-ZLs3kSCv.js" as="script"><link rel="prefetch" href="/assets/Javascript.html-h-Hks2Wb.js" as="script"><link rel="prefetch" href="/assets/vue.html-d_TpxzzM.js" as="script"><link rel="prefetch" href="/assets/get-started.html-BjHi62Nj.js" as="script"><link rel="prefetch" href="/assets/Maven.html-Dxa579SP.js" as="script"><link rel="prefetch" href="/assets/Mybatis-Plus.html-CbxGNMt3.js" as="script"><link rel="prefetch" href="/assets/Spring.html-C8-oxOeL.js" as="script"><link rel="prefetch" href="/assets/Springboot.html-B3a8nJLX.js" as="script"><link rel="prefetch" href="/assets/SpringCloud.html-CWSxyzJ-.js" as="script"><link rel="prefetch" href="/assets/SpringMVC.html-4pDrEj3Z.js" as="script"><link rel="prefetch" href="/assets/redis.html-eT8rxmOk.js" as="script"><link rel="prefetch" href="/assets/404.html-BXcDyVnq.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-DpeUmop8.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="https://www.helloimg.com/i/2024/12/16/675fcc339739b.png" alt="Angelday"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">Angelday</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="首页"><!---->首页<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="JavaEE"><span class="title">JavaEE</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="JavaEE"><span class="title">JavaEE</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/get-started.html" aria-label="Java"><!---->Java<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/database/mysql.html" aria-label="MySQL"><!---->MySQL<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/Maven.html" aria-label="Maven"><!---->Maven<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/Spring.html" aria-label="Spring"><!---->Spring<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/SpringMVC.html" aria-label="SpringMVC"><!---->SpringMVC<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/Springboot.html" aria-label="SpringBoot"><!---->SpringBoot<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/Mybatis-Plus.html" aria-label="Mybatis-Plus"><!---->Mybatis-Plus<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/SpringCloud.html" aria-label="SpringCloud"><!---->SpringCloud<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/database/redis.html" aria-label="Redis"><!---->Redis<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端"><span class="title">前端</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端"><span class="title">前端</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/frontEnd/html.html" aria-label="HTML"><!---->HTML<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/frontEnd/css.html" aria-label="CSS"><!---->CSS<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/frontEnd/Javascript.html" aria-label="JavaScript"><!---->JavaScript<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/frontEnd/Vue.html" aria-label="Vue"><!---->Vue<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/anime.html" aria-label="Anime"><!---->Anime<!----></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="首页"><!---->首页<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="JavaEE"><span class="title">JavaEE</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="JavaEE"><span class="title">JavaEE</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/get-started.html" aria-label="Java"><!---->Java<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/database/mysql.html" aria-label="MySQL"><!---->MySQL<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/Maven.html" aria-label="Maven"><!---->Maven<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/Spring.html" aria-label="Spring"><!---->Spring<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/SpringMVC.html" aria-label="SpringMVC"><!---->SpringMVC<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/Springboot.html" aria-label="SpringBoot"><!---->SpringBoot<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/Mybatis-Plus.html" aria-label="Mybatis-Plus"><!---->Mybatis-Plus<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/JavaEE/SpringCloud.html" aria-label="SpringCloud"><!---->SpringCloud<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/database/redis.html" aria-label="Redis"><!---->Redis<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端"><span class="title">前端</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端"><span class="title">前端</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/frontEnd/html.html" aria-label="HTML"><!---->HTML<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/frontEnd/css.html" aria-label="CSS"><!---->CSS<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/frontEnd/Javascript.html" aria-label="JavaScript"><!---->JavaScript<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/frontEnd/Vue.html" aria-label="Vue"><!---->Vue<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/anime.html" aria-label="Anime"><!---->Anime<!----></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">MySQL <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content" vp-content><!--[--><!--]--><div><h1 id="mysql" tabindex="-1"><a class="header-anchor" href="#mysql"><span>MySQL</span></a></h1><h2 id="基础知识" tabindex="-1"><a class="header-anchor" href="#基础知识"><span>基础知识</span></a></h2><h3 id="sql语句的分类" tabindex="-1"><a class="header-anchor" href="#sql语句的分类"><span>SQL语句的分类</span></a></h3><ul><li>DDL(数据定义语言):对表的增删改</li><li>DML(数据操作语言):增删改</li><li>DQL(数据查询语言):查询</li><li>DCL(数据控制语言):grant授权、revoke撤销权限</li><li>TCL(事务控制语言):commit提交事务，rollback回滚事物</li></ul><h3 id="通用语法规则" tabindex="-1"><a class="header-anchor" href="#通用语法规则"><span>通用语法规则</span></a></h3><ol><li>可以多行，以分号结尾。</li><li>可以使用空格/缩进</li><li>不区分大小写，关键字建议使用大写。</li><li>注释方式: 单行注释: --注释内容 #注释内容(MySQL特有) 多行注释: / * 注释内容 * /</li></ol><h3 id="数据类型" tabindex="-1"><a class="header-anchor" href="#数据类型"><span>数据类型</span></a></h3><p><img src="/assets/SQLDataType-Do0TV0cC.png" alt="在这里插入图片描述"></p><h2 id="ddl" tabindex="-1"><a class="header-anchor" href="#ddl"><span>DDL</span></a></h2><h3 id="对库操作" tabindex="-1"><a class="header-anchor" href="#对库操作"><span>对库操作</span></a></h3><p>注意:中括号内的语句可以省略</p><ol><li>查询所有数据库</li></ol><blockquote><p>SHOW DATABASES;</p></blockquote><ol start="2"><li>查询当前数据库</li></ol><blockquote><p>SELECT DATABASE();</p></blockquote><ol start="3"><li>创建数据库</li></ol><blockquote><p>CREATE DATABASE [IF NOT EXISTS] database_name;</p></blockquote><ol start="4"><li>删除数据库</li></ol><blockquote><p>DROP DATABASE [IF EXISTS] database_name;</p></blockquote><ol start="5"><li>使用/进入数据库</li></ol><blockquote><p>USE database_name;</p></blockquote><h3 id="对表操作" tabindex="-1"><a class="header-anchor" href="#对表操作"><span>对表操作</span></a></h3><ol><li>查询表</li></ol><blockquote><p>SHOW TABLES;</p></blockquote><ol start="2"><li>查询表结构</li></ol><blockquote><p>DESC table_name;</p></blockquote><ol start="3"><li>查询建表语句</li></ol><blockquote><p>SHOW CREATE TABLE table_name;</p></blockquote><ol start="4"><li>创建表</li></ol><blockquote><p>CREATE TABLE table_name( 字段1 数据类型1, 字段2 数据类型2, ... 字段n 数据类型n );[注释]</p></blockquote><ol start="5"><li><p>修改表</p><ul><li>添加字段</li></ul><blockquote><p>ALTER TABLE table_name ADD 字段名 数据类型;</p></blockquote><ul><li>修改数据类型</li></ul><blockquote><p>ALTER TABLE table_name MODIFY 字段名 新字段名;</p></blockquote><ul><li>修改列名和数据类型</li></ul><blockquote><p>ALTER TABLE table_name CHANGE 旧字段名 新字段名 新数据类型;</p></blockquote><ul><li>删除一列</li></ul><blockquote><p>ALTER TABLE table_name DROP 列名;</p></blockquote><ul><li>修改表名</li></ul><blockquote><p>ALTER TABLE table_name RENAME TO 新表名;</p></blockquote></li><li><p>删除表</p></li></ol><blockquote><p>DROP TABLE [IF EXISTS] table_name; 删除表，并重新创建该表 TRUNCATE TABLE table_name;</p></blockquote><h2 id="dml" tabindex="-1"><a class="header-anchor" href="#dml"><span>DML</span></a></h2><h3 id="添加数据" tabindex="-1"><a class="header-anchor" href="#添加数据"><span>添加数据</span></a></h3><ol><li><p>给指定字段添加数据</p><blockquote><p>INSERT INTO table_name (字段名1，字段名2,...) VALUES (值1,值2,..);</p></blockquote></li><li><p>添加一行数据</p><blockquote><p>INSERT INTO table_name VALUES (值1,值2,.….);</p></blockquote></li><li><p>批量向某字段添加数据</p><blockquote><p>INSERT INTO table_name (字段名1，字段名2,...) VALUES (值1,值2,...),(值1，值2,..….);</p></blockquote></li><li><p>批量全部字段添加数据</p><blockquote><p>INSERT INTO table_name VALUES (值1,值2,...) , (值1,值2,...);</p></blockquote></li></ol><p><strong>注意：</strong></p><ul><li>插入数据时，字段顺序要与值的顺序一致</li><li>字符串和日期型数据应该包含在引号中</li></ul><h3 id="修改数据" tabindex="-1"><a class="header-anchor" href="#修改数据"><span>修改数据</span></a></h3><blockquote><p>UPDATE table_name SET 字段名1 = 值1，字段名2 = 值2,.... [WHERE条件];</p></blockquote><h3 id="删除数据" tabindex="-1"><a class="header-anchor" href="#删除数据"><span>删除数据</span></a></h3><blockquote><p>DELETE FROM table_name [WHERE条件];</p></blockquote><p><strong>注意:</strong> 如果没有添加条件，数据会全部删除</p><h2 id="dql" tabindex="-1"><a class="header-anchor" href="#dql"><span>DQL</span></a></h2><h3 id="基本查询" tabindex="-1"><a class="header-anchor" href="#基本查询"><span>基本查询</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表名<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><p>给返回的字段起一个别名</p><blockquote><p>SELECT 字段1 [AS] &#39;别名1&#39; FROM 表名;</p></blockquote></li><li><p>去除重复记录</p><blockquote><p>SELECT DISTINCT 字段列表 FROM table_name;</p></blockquote></li></ul><p><strong>注意</strong></p><ul><li>DISTINCT只能出现在所有字段的正前方</li><li>当列名有多个的时，所有字段完全一样的才去重复</li></ul><p>实例:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">--统计岗位数量</span></span>
<span class="line"><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> job<span class="token punctuation">)</span> <span class="token keyword">FROM</span> emp<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="条件查询" tabindex="-1"><a class="header-anchor" href="#条件查询"><span>条件查询</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> table_name <span class="token keyword">WHERE</span> 条件列表<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>在了解条件查询之前首先我们要知道<code>mysql</code>中一些基本的<code>运算符</code></p><table><thead><tr><th style="text-align:center;">运算符分类</th><th style="text-align:center;">运算符</th><th style="text-align:center;">含义</th></tr></thead><tbody><tr><td style="text-align:center;">算数运算符</td><td style="text-align:center;">+、-、*、/、%</td><td style="text-align:center;">与Java含义一致</td></tr><tr><td style="text-align:center;">比较运算符</td><td style="text-align:center;">=、&gt;、&lt;、&gt;=、&lt;=、&lt;&gt;或!=</td><td style="text-align:center;">&lt;&gt;也是不等于</td></tr><tr><td style="text-align:center;">比较运算符</td><td style="text-align:center;">IS NULL 、IS NOT NULL、IN、BETWEEN AND</td><td style="text-align:center;">为空、不为空、在条件中、处于条件范围中</td></tr><tr><td style="text-align:center;">逻辑运算符</td><td style="text-align:center;">AND、OR、NOT</td><td style="text-align:center;">与、或、非</td></tr></tbody></table><p><strong>模糊查询：</strong> LIKE + 占位符</p><table><thead><tr><th style="text-align:center;">占位符</th><th style="text-align:center;">含义</th></tr></thead><tbody><tr><td style="text-align:center;">_(下划线)</td><td style="text-align:center;">匹配任意单个字符</td></tr><tr><td style="text-align:center;">%</td><td style="text-align:center;">匹配任意多个字符</td></tr></tbody></table><p>示例：</p><ul><li>查询emp中年龄在15岁到20岁之间的</li></ul><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> age <span class="token operator">BETWEEN</span> <span class="token number">15</span> <span class="token operator">AND</span> <span class="token number">20</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>查询emp中姓张的人员信息</li></ul><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">--要求找出姓张的即可，直接使用占位符%</span></span>
<span class="line"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> name <span class="token operator">LIKE</span> <span class="token string">&#39;张%&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="聚合函数" tabindex="-1"><a class="header-anchor" href="#聚合函数"><span>聚合函数</span></a></h3><p>将一列数据作为一个整体，进行纵向计算。</p><table><thead><tr><th style="text-align:center;">函数名</th><th style="text-align:center;">含义</th></tr></thead><tbody><tr><td style="text-align:center;">COUNT</td><td style="text-align:center;">统计数量</td></tr><tr><td style="text-align:center;">MAX</td><td style="text-align:center;">最大值</td></tr><tr><td style="text-align:center;">MIN</td><td style="text-align:center;">最小值</td></tr><tr><td style="text-align:center;">AVG</td><td style="text-align:center;">平均值</td></tr><tr><td style="text-align:center;">SUM</td><td style="text-align:center;">求和</td></tr></tbody></table><p>语法：</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> 聚合函数<span class="token punctuation">(</span>字段列表<span class="token punctuation">)</span> <span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>NULL 不参与所有的聚合函数运算</p></blockquote><p>案例： 统计emp员工表中员工的数量</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> emp<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="分组查询" tabindex="-1"><a class="header-anchor" href="#分组查询"><span>分组查询</span></a></h3><p>语法：</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> table_name <span class="token punctuation">[</span><span class="token keyword">WHERE</span>条件<span class="token punctuation">]</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 分组字段名 <span class="token punctuation">[</span><span class="token keyword">HAVING</span> 分组后过滤条件<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>WHERE与HAVING的区别</strong></p><ul><li>执行时机不同: where是分组之前进行过滤，不满足where条件，不参与分组;而having是分组之后对结果进行过滤。</li><li>判断条件不同: where不能对聚合函数进行判断，而having可以。</li></ul><p>案例 查询emp年龄小于45的员工，并根据地址分组，获取员工数量大于等于3的地址</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">--我们拆开解析，首先先查询年龄小于45的员工的数量</span></span>
<span class="line"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> age <span class="token operator">&lt;</span> <span class="token number">45</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">--然后我们根据地址的不同对齐分组</span></span>
<span class="line"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> age <span class="token operator">&lt;</span> <span class="token number">45</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> address<span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">--最后我们筛选员工数大于等于3的地址</span></span>
<span class="line"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> emp <span class="token keyword">WHERE</span> age <span class="token operator">&lt;</span> <span class="token number">45</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> address <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>执行顺序：where &gt; 聚合函数 &gt; having 分组之后，查询的字段一般为聚合函数和分组字段，查询其他字段无任何意义。</p></blockquote><h3 id="排序查询" tabindex="-1"><a class="header-anchor" href="#排序查询"><span>排序查询</span></a></h3><p>语法:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> table_name <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 字段<span class="token number">1</span> 排序方式<span class="token number">1</span>，字段<span class="token number">2</span> 排序方式<span class="token number">2</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>排序方式:</p><ul><li>ASC 升序(默认方式)</li><li>*DESC 降序</li></ul><blockquote><p>注意:多字段排序，当第一个字段值相同时，才会根据第二个字段进行排序。</p></blockquote><h3 id="分页查询" tabindex="-1"><a class="header-anchor" href="#分页查询"><span>分页查询</span></a></h3><p>语法:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> table_name <span class="token keyword">LIMIT</span> 起始索引 <span class="token punctuation">,</span> 查询记录数<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>注意:</p><ul><li>起始索引从0开始，<code>起始索引</code>=(<code>查询页码</code>-<code>1</code>)*<code>每页显示记录数</code>。</li><li>分页查询不同的数据库有不同的实现，MySQL是<code>LIMIT</code>。</li><li>如果查询的是第一页数据，起始索引可以省略，直接简写为<code>LIMIT</code> 查询记录数。</li></ul><h2 id="多表查询" tabindex="-1"><a class="header-anchor" href="#多表查询"><span>多表查询</span></a></h2><p>首先了解改章的表结构</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> student <span class="token punctuation">(</span>  </span>
<span class="line">    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>  </span>
<span class="line">    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </span>
<span class="line">    class_id <span class="token keyword">INT</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token comment">-- 其他字段...  </span></span>
<span class="line">    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>class_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> class<span class="token punctuation">(</span>id<span class="token punctuation">)</span>  </span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> class <span class="token punctuation">(</span>  </span>
<span class="line">    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>  </span>
<span class="line">    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token comment">-- 其他字段...  </span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="表与表的关系" tabindex="-1"><a class="header-anchor" href="#表与表的关系"><span>表与表的关系</span></a></h3><ol><li>一对多 <ul><li>一个班级有多个学生</li><li>一个学生对应一个班级</li></ul></li><li>多对多 <ul><li>一个学生可以选多门课</li><li>一门课程可以被多个学生选择</li></ul></li><li>一对一 <ul><li>学生与学生详细信息表</li><li>多用与单表拆分，将一张表的基础字段放在一张表中，其他详细字段放在另一张表中</li></ul></li></ol><p>例如：我们在查询学生和其所在班级两张表时如果直接使用</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token punctuation">,</span> class<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>我们会发现，返回的结果数是<code>student</code>中条数乘以<code>class</code>中的条数。 这种现象我们称之为<code>笛卡尔积</code>。 因此我们需要<code>消除无用数据</code>，并<code>保留有效数据</code>。</p><h3 id="查询方式的分类" tabindex="-1"><a class="header-anchor" href="#查询方式的分类"><span>查询方式的分类</span></a></h3><p>查询A、B两个表的交集部分数据，叫做内连接。 查询A的全部数据，并查询出A、B的交集部分数据，叫做左外连接 同理还有B的右外连接 若表与自身的连接查询，叫做自连接。</p><blockquote><p>注意：自连接由于都是这一个表，所有我们需要给它起别名</p></blockquote><h3 id="内连接" tabindex="-1"><a class="header-anchor" href="#内连接"><span>内连接</span></a></h3><p>隐式内连接</p><blockquote><p>SELECT 字段列表 FROM 表1 , 表2 WHERE 条件...;</p></blockquote><p>案例：使用隐式内连接的查询学生名称和其班级名称</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>name<span class="token punctuation">,</span>class<span class="token punctuation">.</span>name <span class="token keyword">FROM</span> student <span class="token punctuation">,</span> class <span class="token keyword">WHERE</span> student<span class="token punctuation">.</span>class_id <span class="token operator">=</span> class<span class="token punctuation">.</span>id<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>显式内连接</p><blockquote><p>SELECT 字段列表 FROM 表1 [INNER] JOIN 表2 ON 连接条件...;</p></blockquote><p>同样的案例我们使用显式内连接的方式</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>name<span class="token punctuation">,</span>class<span class="token punctuation">.</span>name <span class="token keyword">FROM</span> student <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> class <span class="token keyword">ON</span> student<span class="token punctuation">.</span>class_id <span class="token operator">=</span> class<span class="token punctuation">.</span>id<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="外连接" tabindex="-1"><a class="header-anchor" href="#外连接"><span>外连接</span></a></h3><p>左外连接</p><blockquote><p>SELECT 字段列表 FROM 表1 LEFT [OUTER] JOIN 表2 ON 条件...;</p></blockquote><p>案例：查询所有学生及其所在班级的名称，即使某些学生没有分配到班级</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>name <span class="token keyword">FROM</span> student <span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> class <span class="token keyword">ON</span> student<span class="token punctuation">.</span>class_id <span class="token operator">=</span> class<span class="token punctuation">.</span>id<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>右外连接</p><blockquote><p>SELECT 字段列表 FROM 表1 RIGHT [OUTER] JOIN 表2 ON条件...;</p></blockquote><ul><li>注意： 在MySQL中，实际上并不直接支持右外连接<code>RIGHT OUTER JOIN</code>。但是，你可以通过调整查询中的表顺序并使用左外连接<code>LEFT OUTER JOIN</code>来模拟右外连接的效果。</li></ul><h3 id="自连接" tabindex="-1"><a class="header-anchor" href="#自连接"><span>自连接</span></a></h3><blockquote><p>SELECT 字段列表 FROM 表A 别名A JOIN 表A 别名B ON 条件...;</p></blockquote><p>案例：查找哪些学生在同一个班级</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> </span>
<span class="line">	s1<span class="token punctuation">.</span>name <span class="token keyword">AS</span> student1<span class="token punctuation">,</span> </span>
<span class="line">	s2<span class="token punctuation">.</span>name <span class="token keyword">AS</span> student2 </span>
<span class="line"><span class="token keyword">FROM</span> student s1 </span>
<span class="line"><span class="token keyword">JOIN</span> student s2 </span>
<span class="line"><span class="token keyword">ON</span> s1<span class="token punctuation">.</span>class_id <span class="token operator">=</span> s2<span class="token punctuation">.</span>class_id</span>
<span class="line"><span class="token keyword">WHERE</span> s1<span class="token punctuation">.</span>id <span class="token operator">&lt;</span> s2<span class="token punctuation">.</span>id<span class="token punctuation">;</span><span class="token comment">--避免重复和自身匹配</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="联合查询-union查询" tabindex="-1"><a class="header-anchor" href="#联合查询-union查询"><span>联合查询（UNION查询）</span></a></h3><p><strong>概念：</strong> 允许将两个或更多的SELECT语句的结果集组合成一个结果集。<br> 每个SELECT语句在UNION运算符之前，并且所有SELECT语句必须拥有相同列。</p><p><strong>分类：</strong></p><ul><li>UNION ALL会将全部的数据直接合并在一起</li><li>UNION会对合并之后的数据去重。</li></ul><p>案例：我们想要查询所有学生的名字和所有班级的名字，并将这两个结果集合并成一个单一的列表</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 查询所有学生的名字  </span></span>
<span class="line"><span class="token keyword">SELECT</span> name  </span>
<span class="line"><span class="token keyword">FROM</span> student  </span>
<span class="line"><span class="token keyword">UNION</span>  </span>
<span class="line"><span class="token comment">-- 查询所有班级的名字  </span></span>
<span class="line"><span class="token keyword">SELECT</span> name  </span>
<span class="line"><span class="token keyword">FROM</span> class<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="子查询-嵌套查询" tabindex="-1"><a class="header-anchor" href="#子查询-嵌套查询"><span>子查询/嵌套查询</span></a></h3><blockquote><p>--外部可以是<code>INSERT</code> <code>UPDATE</code> <code>SELECT</code> SELECT * FROM 表1 WHERE 字段1 = (SELECT 字段1 FROM 表2);</p></blockquote><p>案例:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token comment">-- 找出至少有一个学生所在的班级  </span></span>
<span class="line"><span class="token keyword">SELECT</span> name  </span>
<span class="line"><span class="token keyword">FROM</span> class  </span>
<span class="line"><span class="token keyword">WHERE</span> id <span class="token operator">IN</span> <span class="token punctuation">(</span>  </span>
<span class="line">    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> class_id  </span>
<span class="line">    <span class="token keyword">FROM</span> student  </span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>根据子查询结果不同又分为</p><ul><li>标量子查询(子查询结果为单个值)</li><li>列子查询(子查询结果为一列)</li><li>行子查询(子查询结果为一行)</li><li>表子查询(子查询结果为多行多列列)</li></ul><p><strong>操作符</strong></p><ul><li>ANY(SOME) 子查询返回列表中，有一个满足即可</li><li>ALL必须满足所有</li></ul><h2 id="函数" tabindex="-1"><a class="header-anchor" href="#函数"><span>函数</span></a></h2><h3 id="数值函数" tabindex="-1"><a class="header-anchor" href="#数值函数"><span>数值函数</span></a></h3><ul><li>向上取整</li></ul><blockquote><p>CEIL(x)</p></blockquote><ul><li>向下取整</li></ul><blockquote><p>FLOOR(x)</p></blockquote><ul><li>返回x/y的模</li></ul><blockquote><p>MOD(x,y)</p></blockquote><ul><li>返回0~1内的随机数</li></ul><blockquote><p>RAND()</p></blockquote><ul><li>求参数x的四舍五入的值,并保留y位的小数</li></ul><blockquote><p>ROUND(x,y)</p></blockquote><h3 id="字符串函数" tabindex="-1"><a class="header-anchor" href="#字符串函数"><span>字符串函数</span></a></h3><ul><li>字符串拼接，将S1，S2，S3拼接成一个字符串</li></ul><blockquote><p>CONCAT(S1,S2,S3)</p></blockquote><ul><li>将字符串&#39;str&#39;全部转换为小写</li></ul><blockquote><p>LOWER(&#39;str&#39;)</p></blockquote><ul><li>将字符串&#39;str&#39;全部转化为大写</li></ul><blockquote><p>UPPER(&#39;str&#39;)</p></blockquote><ul><li>左填充用字符串pad对str的左边进行填充，达到n个字符串长度</li></ul><blockquote><p>LPAD(str,n,pad)</p></blockquote><ul><li>右填充，用字符串pad对str的右边进行填充，达到n个字符串长度</li></ul><blockquote><p>RPAD(str,n,pad)</p></blockquote><ul><li>去掉字符串头部和尾部的空格</li></ul><blockquote><p>TRIM(str)</p></blockquote><ul><li>返回从字符串str从start位置开始的len个长度的字符串</li></ul><blockquote><p>SUBSTRING(str,start,len)</p></blockquote><h3 id="日期函数" tabindex="-1"><a class="header-anchor" href="#日期函数"><span>日期函数</span></a></h3><ul><li>返回当前日期</li></ul><blockquote><p>CURDATE()</p></blockquote><ul><li>返回当前时间</li></ul><blockquote><p>CURTIME()</p></blockquote><ul><li>返回当前日期和时间</li></ul><blockquote><p>NOW()</p></blockquote><ul><li>获取指定‘date’的年份</li></ul><blockquote><p>YEAR(date)</p></blockquote><ul><li>获取指定‘date’的月份</li></ul><blockquote><p>MONTH(date)</p></blockquote><ul><li>获取指定‘date’的日期</li></ul><blockquote><p>DAY(date)</p></blockquote><ul><li>返回一个日期/时间值加上一个时间间隔‘exper’后的时间值</li></ul><blockquote><p>DATE_ADD(date, INTERVAL expr type)</p></blockquote><ul><li>返回起始时间‘date1’和结束时间‘date2’之间的天数</li></ul><blockquote><p>DATEDIFF(date1,date2)</p></blockquote><h3 id="流程函数" tabindex="-1"><a class="header-anchor" href="#流程函数"><span>流程函数</span></a></h3><ul><li>如果value为true，则返回t，否则返回 f</li></ul><blockquote><p>lF(value , t , f)</p></blockquote><ul><li>如果value1不为空, 返回value1，否则返回value2</li></ul><blockquote><p>IFNULL(value1 , value2)</p></blockquote><ul><li>如果val1为true，返回res1，...否则返回default默认值</li></ul><blockquote><p>CASE WHEN [vall] THEN [res1] ...ELSE [default] END</p></blockquote><ul><li>如果expr的值等于val1，返回res1,...否则返回default默认值</li></ul><blockquote><p>CASE [expr] WHEN [vall] THEN [res1] ...ELSE [default] END</p></blockquote><h2 id="约束" tabindex="-1"><a class="header-anchor" href="#约束"><span>约束</span></a></h2><p><strong>概念</strong></p><ul><li>约束是作用与字段上的规则，用于限制存储在表中的数据。</li><li>目的是保证数据库中的数据的正确性、有效性、完整性。</li></ul><h3 id="分类" tabindex="-1"><a class="header-anchor" href="#分类"><span>分类</span></a></h3><table><thead><tr><th style="text-align:center;">名称</th><th style="text-align:center;">关键字</th><th style="text-align:center;">含义</th></tr></thead><tbody><tr><td style="text-align:center;">非空约束</td><td style="text-align:center;">NOT NULL</td><td style="text-align:center;">改字段不能为NULL</td></tr><tr><td style="text-align:center;">唯一约束</td><td style="text-align:center;">NUIQUE</td><td style="text-align:center;">该字段不能有重复内容</td></tr><tr><td style="text-align:center;">主键约束</td><td style="text-align:center;">PRIMARY KEY</td><td style="text-align:center;">主键是一行数据的唯一标识，要求非空且唯一</td></tr><tr><td style="text-align:center;">默认约束</td><td style="text-align:center;">DEFAULT</td><td style="text-align:center;">保存数据时，如果未指定该字段的值，则采用默认值</td></tr><tr><td style="text-align:center;">检查约束</td><td style="text-align:center;">CHECK</td><td style="text-align:center;">(8.0.16版本之后)保证字段值满足某一个条件</td></tr><tr><td style="text-align:center;">外键约束</td><td style="text-align:center;">FOREIGN KEY</td><td style="text-align:center;">下面着重讲解</td></tr></tbody></table><blockquote><p>注意：约束作用与字段，在创建/修改表时添加约束</p></blockquote><p>下面是使用例子</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">(</span>  </span>
<span class="line">    column1 datatype <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>  </span>
<span class="line">    column2 datatype <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span></span>
<span class="line">    column3 datatype <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span>
<span class="line">    column4 datatype <span class="token keyword">CHECK</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    column5 datatype <span class="token keyword">DEFAULT</span> <span class="token keyword">value</span><span class="token punctuation">,</span>  </span>
<span class="line">    column6 datatype<span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  </span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="外键约束" tabindex="-1"><a class="header-anchor" href="#外键约束"><span>外键约束</span></a></h3><p>作用：让两张表的数据之间建立连接，从而保证数据的一致性和完整性。</p><p><strong>添加外键</strong></p><ul><li>添加外键方式一</li></ul><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> table_name<span class="token punctuation">(</span></span>
<span class="line">	字段名 数据类型<span class="token punctuation">,</span></span>
<span class="line">	<span class="token punctuation">[</span><span class="token keyword">CONSTRAINT</span><span class="token punctuation">]</span><span class="token punctuation">[</span>外键名称<span class="token punctuation">]</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>外键字段名<span class="token punctuation">)</span></span>
<span class="line">	<span class="token keyword">REFERENCES</span> 主表名<span class="token punctuation">(</span>主表列名<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>方式二</li></ul><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> 外键名称 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>外键字段名<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> 主表 <span class="token punctuation">(</span>主表列名<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>删除外键</strong> 语法</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">DROP</span> FOREINGN <span class="token keyword">KEY</span> 外键名<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>外键 删除 / 更新 行为</p><blockquote><p>NO ACTION / RESTRICT</p></blockquote><p>当在<code>父表</code>中<code>删除/更新</code>对应记录时，首先检查该记录是否有对应<code>外键</code>，如果有则<code>不允许删除/更新</code>。</p><blockquote><p>CASCADE</p></blockquote><p>当在<code>父表</code>中<code>删除/更新</code>对应记录时，首先检查该记录是否有对应外键，如果有，则<code>也删除/更新外键在子表中的记录</code>。</p><blockquote><p>SET NULL</p></blockquote><p>当在<code>父表</code>中<code>删除</code>对应记录时，首先检查该记录是否有对应外键，如果有则<code>设置子表中该外键值为null</code> (这就要求该外键允许取null)</p><blockquote><p>SET DEFAULT</p></blockquote><p><code>父表</code>有变更时，子表<code>将外键列设置成一个默认的值</code>(Innodb不支持)</p><p><strong>使用方法</strong></p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name </span>
<span class="line">	<span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> 外键名称 </span>
<span class="line">	<span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>外键字段<span class="token punctuation">)</span> </span>
<span class="line">	<span class="token keyword">REFERENCES</span> 主表名<span class="token punctuation">(</span>主表字段名<span class="token punctuation">)</span> </span>
<span class="line">	<span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span> </span>
<span class="line">	<span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下面是这段SQL的详细讲解</p><blockquote><p>ALTER TABLE table_name:</p></blockquote><p>这条命令用于修改已存在的表（table_name）。</p><blockquote><p>ADD CONSTRAINT 外键名称</p></blockquote><p>这条命令用于向表中添加一个新的约束，并且为这个约束指定一个名称（外键名称）。这里的“外键名称”是一个占位符，你需要将其替换为具体的外键约束名称。</p><blockquote><p>FOREIGN KEY (外键字段)</p></blockquote><p>这部分指定了哪个字段将被用作外键。外键字段是一个占位符，你需要将其替换为实际的外键字段名。</p><blockquote><p>REFERENCES 主表名(主表字段名)</p></blockquote><p>这部分指定了外键将引用哪个表（主表名）和哪个字段（主表字段名）。主表名和主表字段名都是占位符，你需要将它们替换为实际的主表名和主表字段名。</p><blockquote><p>ON UPDATE CASCADE</p></blockquote><p>它指定了当主表中的主表字段的值被更新时，外键表中对应的外键字段的值也应该被更新。<code>CASCADE</code>表示级联操作，即主表字段的更新会自动传播到外键字段。</p><blockquote><p>ON DELETE CASCADE</p></blockquote><p>它指定了当主表中的记录被删除时，外键表中所有引用该记录的外键字段所在的记录也应该被删除。同样，CASCADE表示级联操作，即主表记录的删除会自动传播到外键表。</p><h2 id="事务" tabindex="-1"><a class="header-anchor" href="#事务"><span>事务</span></a></h2><h3 id="概念" tabindex="-1"><a class="header-anchor" href="#概念"><span>概念</span></a></h3><blockquote><p>事务是一组操作的集合，事务会把所有的操作作为一个整体一起向系统提交或撤销操作请求，即这些操作出错，要么同时成功，要么同时失败。</p></blockquote><p>在 MySQL 中，默认情况下事务是自动提交的。这意味着当执行一条数据操作语言（DML）语句，如 <code>INSERT</code>、<code>UPDATE</code> 或 <code>DELETE</code> 时，<code>MySQL</code> 会立即隐式地提交事务。这种自动提交的行为在某些情况下可能会导致数据不一致或意外的结果。</p><h3 id="查看-设置事务提交方式" tabindex="-1"><a class="header-anchor" href="#查看-设置事务提交方式"><span>查看 / 设置事务提交方式：</span></a></h3><ul><li><code>SELECT @@autocommit;</code>：用于查看当前的自动提交设置。如果返回值为 <code>1</code>，表示自动提交开启；如果返回值为 0，表示自动提交关闭。</li><li><code>SET @@autocommit=0;</code>：设置自动提交为关闭状态。关闭自动提交后，需要手动使用 <code>COMMIT</code> 提交事务或 <code>ROLLBACK</code> 回滚事务来控制事务的结束。</li></ul><p>开启事务：</p><ul><li><code>START TRANSACTION</code> 或 <code>BEGIN;</code>：这两个语句用于开启一个新的事务。在事务开启后，后续的数据库操作将被视为事务的一部分，直到事务被提交或回滚。</li></ul><p>提交事务：</p><ul><li>COMMIT;：当事务中的所有操作都成功执行后，可以使用 <code>COMMIT</code> 语句提交事务。提交事务后，事务中对数据库的更改将被永久保存。</li></ul><p>回滚事务：</p><ul><li><code>ROLLBACK;</code>：如果在事务执行过程中出现错误或需要撤销事务中的操作，可以使用 <code>ROLLBACK</code> 语句回滚事务。回滚事务将撤销事务中对数据库的所有更改，使数据库恢复到事务开始之前的状态。</li></ul><h3 id="事务的特性" tabindex="-1"><a class="header-anchor" href="#事务的特性"><span>事务的特性</span></a></h3><ol><li>原子性 (Atomicity): 事务是不可分割的最小操作单元，要么全部成功，要么全部失败。这意味着如果事务中的任何一个操作失败，整个事务都将被回滚，就好像这个事务从未发生过一样。例如，在一个银行转账的事务中，从一个账户扣除金额和向另一个账户增加金额这两个操作必须同时成功或同时失败，不能出现只完成了一部分操作的情况。</li><li>一致性 (Consistency): 事务完成时，必须使所有的数据都保持一致状态。这意味着事务的执行必须遵循数据库的完整性约束和业务规则。例如，如果一个数据库中有一个表的字段定义了唯一约束，那么在事务中插入的数据不能违反这个唯一约束。如果事务中的操作违反了一致性要求，数据库系统将回滚事务，以确保数据的一致性。</li><li>隔离性（Isolation）: 数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立环境下运行。不同的事务之间应该相互隔离，互不干扰。然而，由于并发事务的存在，可能会引发一些问题，如脏读、不可重复读和幻读。为了解决这些问题，数据库系统提供了不同的事务隔离级别。</li><li>持久性（Durability）︰ 事务一旦提交或回滚，它对数据库中的数据的改变就是永久的。这意味着即使在数据库系统发生故障的情况下，已经提交的事务的结果也不会丢失。数据库系统通常会使用日志和备份等技术来保证事务的持久性。</li></ol><h3 id="并发事务引发的问题" tabindex="-1"><a class="header-anchor" href="#并发事务引发的问题"><span>并发事务引发的问题</span></a></h3><ol><li>脏读 一个事务读到另外一个事务还没有提交的数据。例如，事务 A 修改了一条数据，但还没有提交，此时事务 B 读取了这条被事务 A 修改的数据。如果事务 A 最终回滚了这个修改，那么事务 B 读取到的数据就是 “脏数据”，因为它实际上并不应该存在于数据库中。</li><li>不可重复读 一个事务先后读取同一条记录，但两次读取的数据不同，称之为不可重复读。例如，事务 A 读取了一条数据，然后事务 B 修改了这条数据并提交，此时事务 A 再次读取这条数据，发现两次读取的数据不同。</li><li>幻读 一个事务按照条件查询数据时，没有对应的数据行，但是在插入数据时，又发现这行数据已经存在，好像出现了幻影。例如，事务 A 按照某个条件查询数据，没有找到符合条件的数据行，然后事务 B 插入了一条符合事务 A 查询条件的数据并提交，此时事务 A 再次按照相同的条件查询数据，却发现了刚才事务 B 插入的数据行。</li></ol><h3 id="事务隔离级别-解决以上问题" tabindex="-1"><a class="header-anchor" href="#事务隔离级别-解决以上问题"><span>事务隔离级别，解决以上问题</span></a></h3><ol><li>Read uncommitted（读未提交） 在这个隔离级别下，一个事务可以读取另一个事务未提交的数据，这会导致脏读、不可重复读和幻读问题都可能发生。虽然这个隔离级别可以提供最高的并发性能，但由于数据的不一致性风险较高，一般不建议在实际应用中使用。</li><li>Read committed（读已提交） 在这个隔离级别下，一个事务只能读取另一个事务已经提交的数据，可以避免脏读问题，但不可重复读和幻读问题仍然可能发生。这个隔离级别在很多数据库系统中是默认的隔离级别，它提供了一定程度的数据一致性和较好的并发性能。</li><li>Repeatable Read (MySQL 默认) 在这个隔离级别下，一个事务在执行过程中多次读取同一数据时，会得到相同的结果，即可以避免不可重复读问题。但是，幻读问题仍然可能发生。MySQL 使用多版本并发控制（MVCC）技术来实现这个隔离级别，通过保存数据的多个版本，使得不同的事务可以看到不同版本的数据，从而保证了事务的隔离性。</li><li>Serializable（可串行化） 在这个隔离级别下，事务之间是完全隔离的，就像事务是依次执行的一样，可以避免脏读、不可重复读和幻读问题。但是，这个隔离级别会极大地降低数据库的并发性能，因为它需要对事务进行严格的锁定，以确保事务之间的完全隔离。</li></ol><p><strong>查看事务隔离级别：</strong></p><ul><li>SELECT @@TRANSACTION_ISOLATION;：用于查看当前数据库的事务隔离级别。 <strong>设置事务隔离级别：</strong></li><li><code>SET [SESSION|GLOBAL] TRANSACTION ISOLATION LEVEL {READUNCOMMITTED |READCOMMITTED |REPEATABLE READ|SERIALIZABLE };</code>：可以使用这个语句设置事务隔离级别。其中，<code>SESSION</code> 表示只对当前会话生效，<code>GLOBAL</code> 表示对所有新连接的会话生效。选择合适的事务隔离级别需要在数据一致性和并发性能之间进行权衡。在实际应用中，需要根据具体的业务需求和场景来选择合适的事务隔离级别，以达到最佳的性能和数据一致性。</li></ul></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BuZoRmWt.js" defer></script>
  </body>
</html>
